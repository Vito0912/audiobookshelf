components:
  schemas:
    oldLibraryItemId:
      description: The ID of library items on server version 2.2.23 and before.
      type: string
      nullable: true
      format: 'li_[a-z0-9]{18}'
      example: li_o78uaoeuh78h6aoeif
    libraryItemId:
      type: string
      description: The ID of library items after 2.3.0.
      format: uuid
      example: e4bb1afb-4a4f-4dd6-8be0-e615d233185b
    libraryItemBase:
      type: object
      description: Base library item schema
      properties:
        id:
          $ref: '#/components/schemas/libraryItemId'
        oldLibraryItemId:
          $ref: '#/components/schemas/oldLibraryItemId'
        ino:
          $ref: '../schemas.yaml#/components/schemas/inode'
        libraryId:
          $ref: './Library.yaml#/components/schemas/libraryId'
        folderId:
          $ref: './Folder.yaml#/components/schemas/folderId'
        path:
          description: The path of the library item on the server.
          type: string
        relPath:
          description: The path, relative to the library folder, of the library item.
          type: string
        isFile:
          description: Whether the library item is a single file in the root of the library folder.
          type: boolean
        mtimeMs:
          description: The time (in ms since POSIX epoch) when the library item was last modified on disk.
          type: integer
        ctimeMs:
          description: The time (in ms since POSIX epoch) when the library item status was changed on disk.
          type: integer
        birthtimeMs:
          description: The time (in ms since POSIX epoch) when the library item was created on disk. Will be 0 if unknown.
          type: integer
        addedAt:
          $ref: '../schemas.yaml#/components/schemas/addedAt'
        updatedAt:
          $ref: '../schemas.yaml#/components/schemas/updatedAt'
        isMissing:
          description: Whether the library item was scanned and no longer exists.
          type: boolean
        isInvalid:
          description: Whether the library item was scanned and no longer has media files.
          type: boolean
        mediaType:
          $ref: './mediaTypes/media.yaml#/components/schemas/mediaType'
        media:
          oneOf:
            - $ref: './mediaTypes/Book.yaml#/components/schemas/book'
            - $ref: './mediaTypes/Podcast.yaml#/components/schemas/Podcast'
          discriminator:
            propertyName: mediaType
            mapping:
              book: './mediaTypes/Book.yaml#/components/schemas/book'
              podcast: './mediaTypes/Podcast.yaml#/components/schemas/Podcast'
    libraryItemMinified:
      type: object
      description: A single item on the server, like a book or podcast. Minified media format.
      allOf:
        - $ref: '#/components/schemas/libraryItemBase'
        - type: object
          properties:
            media:
              $ref: './mediaTypes/media.yaml#/components/schemas/mediaMinified'
    libraryItem:
      type: object
      description: A single item on the server, like a book or podcast.
      allOf:
        - $ref: '#/components/schemas/libraryItemBase'
        - type: object
          properties:
            libraryFiles:
              type: array
              items:
                $ref: './files/AudioFile.yaml#/components/schemas/libraryFile'
    libraryItemSequence:
      type: object
      description: A single item on the server, like a book or podcast. Includes series sequence information.
      allOf:
        - $ref: '#/components/schemas/libraryItemBase'
        - type: object
          properties:
            sequence:
              $ref: './entities/Series.yaml#/components/schemas/sequence'
    libraryItemExpanded:
      type: object
      allOf:
        - $ref: '#/components/schemas/libraryItemBase'
        - type: object
          properties:
            size:
              $ref: '../schemas.yaml#/components/schemas/size'
            media:
              oneOf:
                - $ref: './mediaTypes/Book.yaml#/components/schemas/bookExpanded'
                - $ref: './mediaTypes/Podcast.yaml#/components/schemas/Podcast'
              discriminator:
                propertyName: mediaType
                mapping:
                  book: './mediaTypes/Book.yaml#/components/schemas/bookExpanded'
                  podcast: './mediaTypes/Podcast.yaml#/components/schemas/Podcast'
    libraryItemSearchResult:
      type: object
      properties:
        libraryItem:
          $ref: '#/components/schemas/libraryItemExpanded'
        matchKey:
          nullable: true
          type: string
        matchText:
          nullable: true
          type: string
    libraryItemShelf:
      type: object
      description: A single episode of a podcast.
      allOf:
        - $ref: '#/components/schemas/libraryItem'
        - type: object
          properties:
            recentEpisode:
              $ref: './entities/PodcastEpisode.yaml#/components/schemas/PodcastEpisode'
            progressLastUpdate:
              description: An Integer, the time (in ms since POSIX epoch) when the book's or episode's progress was last updated.
              type: integer
              example: 1612345678901
              nullable: true
            prevBookInProgressLastUpdate:
              description: An Integer, the time (in ms since POSIX epoch) when the book's or episode's progress was last updated.
              type: integer
              example: 1612345678901
              nullable: true
            recommended:
              description:  A Float, the recommendation weight of the library item.
              type: number
              example: 0.5
              nullable: true
            finishedAt:
              description: An Integer, the time (in ms since POSIX epoch) when the book or episode was finished.
              type: integer
              example: 1612345678901
              nullable: true
        - $ref: '../objects/entities/Series.yaml#/components/schemas/seriesShelf'
    libraryFilterData:
      type: object
      properties:
        authors:
          type: array
          items:
            $ref: '../objects/entities/Author.yaml#/components/schemas/authorMinified'
        series:
          type: array
          items:
            $ref: '../objects/entities/Series.yaml#/components/schemas/seriesNumBooks'
        tags:
          type: array
          items:
            type: string
        genres:
          type: array
          items:
            type: string
        narrators:
          type: array
          items:
            type: string
        languages:
          type: array
          items:
            type: string
